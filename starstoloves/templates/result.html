{% load humanize %}

<div class="js-result" data-status="{{ mapping.status }}" data-id="{{ mapping.id }}">
    {% if mapping.status == 'SUCCESS' %}
        {% if mapping.results %}
            <ul class="js-toggle-more result-list">
                {% for track_result in mapping.results %}
                    <li class="js-toggle-more-item result">
                        <label>
                            <input
                                class="result-select"
                                type="checkbox"
                                name="love_tracks"
                                value="{{ track_result.url }}"
                            />
                            <span class="result-track">
                                {% if track_result.loved %}
                                    <span class="result-love">♥</span>
                                {% endif %}
                                {{track_result.artist_name}} - {{track_result.track_name}}
                                <a
                                    class="result-link"
                                    href="{{ track_result.url }}"
                                    title="View on Last.fm"
                                    target="_blank"
                                >⇗</a>
                            </span>
                            <span class="result-listeners">{{ track_result.listeners|intcomma }} listeners</span>
                        </label>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No Last.fm tracks found, <a href="http://www.last.fm/search?q={{mapping.track.artist_name}} {{mapping.track.track_name}}&amp;type=track">try searching manually</a></p>
        {% endif %}
    {% elif track.status == 'FAILURE' %}
        <p>Last.fm search failed, <a href="http://www.last.fm/search?q={{mapping.track.artist_name}} {{mapping.track.track_name}}&amp;type=track">try searching manually</a></p>
    {% endif %}
</div>